<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
	<Package Language="1043" Name="CoursesManager" Version="$(var.ProductVersion)" InstallerVersion="500" Compressed="yes" Manufacturer="A3Solutions" UpgradeCode="1F356BD1-1BCC-48B5-8B4C-FFAEBA3CA2AD">
		<MediaTemplate EmbedCab="yes"/>

		<MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="Een nieuwere versie is al geÃ¯nstalleerd." Schedule="afterInstallInitialize" />

		<WixVariable Id="WixUILicenseRtf" Value="License.rtf" />

		<!-- <Binary Id="CustomActionsDll" SourceFile="lib\CustomActions.CA.dll" />
		<CustomAction Id="ReadAppConfig" BinaryRef="CustomActionsDll" DllEntry="ReadAppConfig" Execute="immediate" />

		<InstallUISequence>
			<Custom Action="ReadAppConfig" Before="CostFinalize" Condition="NOT Installed" />
		</InstallUISequence>

		<Property Id="DB_SERVER" Value="localhost" />
        <Property Id="DB_NAME" Value="MyDatabase" />
        <Property Id="DB_USER" Value="admin" />
        <Property Id="DB_PASSWORD" Value="example" /> -->
		
        <ui:WixUI Id="WixUI_Minimal" InstallDirectory="INSTALLFOLDER" />

		<StandardDirectory Id="DesktopFolder" />

		<ComponentGroup Id="AutoGeneratedComponents">
			<Files Include="..\CoursesManager.UI\bin\$(var.Platform)\$(var.Configuration)\net8.0-windows\**" />
		</ComponentGroup>

		<ComponentGroup Id="MainComponents">
			<Component Id="MainExecutable" Guid="49BCCDE1-5E00-452A-85D3-81B6FCE3DE20">
	            <Shortcut Id="DesktopShortcut" Directory="DesktopFolder" Name="CoursesManager" WorkingDirectory="INSTALLFOLDER" Target="[INSTALLFOLDER]CoursesManager.UI.exe" />

	            <RemoveFile Id="RemoveDesktopShortcut" Name="CoursesManager.lnk" Directory="DesktopFolder" On="uninstall"/>

				<RegistryValue Root="HKCU" Key="Software\A3\CoursesManager" Name="installed" Type="integer" Value="1" KeyPath="yes" />
	        </Component>
		</ComponentGroup>

        <Feature Id="Complete" Level="1">
            <ComponentGroupRef Id="MainComponents"/>
    		<ComponentGroupRef Id="AutoGeneratedComponents"/>
        </Feature>
	</Package>
</Wix>